class r{constructor(t=".two-factor"){var e;if(this.container=document.querySelector(t),!this.container){console.error(`TwoFactorAuth: Container "${t}" not found.`);return}if(this.inputs=Array.from(this.container.querySelectorAll("input")),this.inputs.length===0){console.error("TwoFactorAuth: No input fields found in the container.");return}this.confirmBtn=(e=this.container.closest("form"))==null?void 0:e.querySelector('button[type="submit"]'),this.init()}init(){this.inputs[0].focus(),this.inputs.forEach((t,e)=>{t.setAttribute("inputmode","numeric"),t.setAttribute("maxlength","1"),t.addEventListener("input",n=>this.handleInput(n,e)),t.addEventListener("keydown",n=>this.handleKeyDown(n,e)),t.addEventListener("paste",this.preventPaste)}),this.confirmBtn?this.confirmBtn.addEventListener("click",t=>this.handleSubmit(t)):console.warn("TwoFactorAuth: Submit button not found.")}handleInput(t,e){let n=t.target.value.replace(/\D/g,"");n.length>1&&(n=n.charAt(0)),this.inputs[e].value=n,n&&e<this.inputs.length-1&&this.inputs[e+1].focus()}handleKeyDown(t,e){t.key==="Backspace"&&!this.inputs[e].value&&e>0&&this.inputs[e-1].focus()}preventPaste(t){t.preventDefault()}handleSubmit(t){t.preventDefault();const e=this.inputs.map(n=>n.value).join("");if(!/^\d+$/.test(e)||e.length!==this.inputs.length){this.showError("Please enter a valid verification code."),setTimeout(()=>this.clearError(),3e3);return}console.log("Entered 2FA code:",e)}showError(t){this.errorSpan||(this.errorSpan=document.createElement("span"),this.errorSpan.className="text-danger d-block mb-3",this.inputs[0].parentElement.insertAdjacentElement("afterend",this.errorSpan)),this.errorSpan.textContent=t}clearError(){this.errorSpan&&(this.errorSpan.remove(),this.errorSpan=null)}}document.addEventListener("DOMContentLoaded",()=>{new r});
